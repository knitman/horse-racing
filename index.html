<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8" />
<title>PHOTO FINISH â€“ Horses</title>
<script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.js"></script>
<style>
body{
    margin:0;
    background:#0f0f1f;
    color:white;
    text-align:center;
    font-family:Arial;
}
</style>
</head>
<body>

<h1>ğŸ PHOTO FINISH ğŸ</h1>
<h3>SPACE = Î–Î¬ÏÎ¹ | R = Restart</h3>
<h3 id="msg"></h3>

<script>
class GameScene extends Phaser.Scene {
    constructor(){ super("game"); }

    preload(){
        this.load.image('horse','horse.png');
    }

    create(){
        this.startX = 150;
        this.finishX = 1000;

        // LANES
        this.lanesY = [];
        for(let i=0;i<6;i++){
            let y = 180 + i*80;
            this.lanesY.push(y);

            let g = this.add.graphics();
            g.fillStyle(0x7a4b20);
            g.fillRect(100, y-35, 950, 70);

            this.add.text(60, y-15, (i+1), {font:'22px Arial', fill:'#fff'});
        }

        // FINISH LINE
        let finish = this.add.graphics();
        finish.fillStyle(0xff0000);
        finish.fillRect(this.finishX, 120, 10, 520);

        // HORSES (Î¯Î´Î¹Î¿ PNG ÏƒÎµ ÎºÎ¬Î¸Îµ lane)
        this.horses = [];
        for(let i=0;i<6;i++){
            let horse = this.add.image(
                this.startX,
                this.lanesY[i],
                'horse'
            ).setScale(0.12);

            horse.posX = this.startX;
            this.horses.push(horse);
        }

        // DICE
        this.diceText = this.add.text(550, 60, "", {
            font:'60px Arial',
            fill:'#fff'
        });

        this.winner = null;

        this.input.keyboard.on('keydown-SPACE', ()=> this.rollDice());
        this.input.keyboard.on('keydown-R', ()=> this.resetGame());
    }

    gallop(horse){
        this.tweens.add({
            targets: horse,
            y: horse.y - 10,
            yoyo: true,
            repeat: 2,
            duration: 80
        });
    }

    rollDice(){
        if(this.winner) return;

        let dice = Phaser.Math.Between(1,6);
        this.diceText.setText(dice);

        let horse = this.horses[dice-1];
        horse.posX += 110;

        this.tweens.add({
            targets: horse,
            x: horse.posX,
            duration: 400
        });

        this.gallop(horse);

        if(horse.posX >= this.finishX){
            this.winner = dice;
            document.getElementById("msg").innerText =
                "ğŸ† ÎÎ¯ÎºÎ·ÏƒÎµ Ï„Î¿ Î†Î»Î¿Î³Î¿ " + dice;
        }
    }

    resetGame(){
        this.horses.forEach((h,i)=>{
            h.posX = this.startX;
            h.x = this.startX;
            h.y = this.lanesY[i];
        });
        this.diceText.setText("");
        this.winner = null;
        document.getElementById("msg").innerText="";
    }
}

new Phaser.Game({
    type: Phaser.AUTO,
    width:1200,
    height:720,
    scene: GameScene
});
</script>

</body>
</html>
