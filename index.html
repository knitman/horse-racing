<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8" />
<title>PHOTO FINISH</title>
<script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.js"></script>
<style>
body{
    margin:0;
    background:#1e5b2a;
    color:white;
    text-align:center;
    font-family:Arial;
}
</style>
</head>
<body>

<h1>üèÅ PHOTO FINISH üèÅ</h1>
<h3>SPACE = ŒñŒ¨œÅŒπ | R = Restart</h3>
<h3 id="msg"></h3>

<script>
class GameScene extends Phaser.Scene {
    constructor(){ super("game"); }

    preload(){
        this.load.image('horse','horse.png');
    }

    create(){
        this.startX = 140;
        this.finishX = 1050;

        // ---------- TRACK ----------
        let grass = this.add.graphics();
        grass.fillStyle(0x1e5b2a);
        grass.fillRect(0, 120, 1200, 520);

        // ---------- LANES ----------
        this.lanesY = [];
        for(let i=0;i<6;i++){
            let y = 190 + i*80;
            this.lanesY.push(y);

            let lane = this.add.graphics();
            lane.fillStyle(0xc9a36a);
            lane.fillRect(100, y-35, 980, 70);

            lane.fillStyle(0xb68f58);
            lane.fillRect(100, y-35, 980, 8);
            lane.fillRect(100, y+27, 980, 8);

            this.add.text(60, y-15, (i+1), {
                font:'22px Arial',
                fill:'#ffffff'
            });
        }

        // ---------- FINISH ----------
        let finish = this.add.graphics();
        finish.fillStyle(0xff0000);
        finish.fillRect(this.finishX, 120, 12, 520);

        // ---------- HORSE COLORS ----------
        const colors = [
            0xff3b3b, // Œ∫œåŒ∫Œ∫ŒπŒΩŒø
            0x3b82ff, // ŒºœÄŒªŒµ
            0xffd93b, // Œ∫ŒØœÑœÅŒπŒΩŒø
            0x3bff57, // œÄœÅŒ¨œÉŒπŒΩŒø
            0xff3bf2, // ŒºœâŒ≤
            0xff8c3b  // œÄŒøœÅœÑŒøŒ∫Œ±ŒªŒØ
        ];

        // ---------- HORSES ----------
        this.horses = [];
        for(let i=0;i<6;i++){
            let horse = this.add.image(
                this.startX,
                this.lanesY[i],
                'horse'
            )
            .setScale(0.09)
            .setTint(colors[i]);

            horse.posX = this.startX;
            this.horses.push(horse);
        }

        // ---------- DICE ----------
        this.diceText = this.add.text(560, 60, "", {
            font:'60px Arial',
            fill:'#ffffff'
        });

        this.winner = null;

        this.input.keyboard.on('keydown-SPACE', ()=> this.rollDice());
        this.input.keyboard.on('keydown-R', ()=> this.resetGame());
    }

    gallop(horse){
        this.tweens.add({
            targets: horse,
            y: horse.y - 8,
            yoyo: true,
            repeat: 2,
            duration: 80
        });
    }

    rollDice(){
        if(this.winner) return;

        let dice = Phaser.Math.Between(1,6);
        this.diceText.setText(dice);

        let horse = this.horses[dice-1];
        horse.posX += 120;

        this.tweens.add({
            targets: horse,
            x: horse.posX,
            duration: 400
        });

        this.gallop(horse);

        if(horse.posX >= this.finishX){
            this.winner = dice;
            document.getElementById("msg").innerText =
                "üèÜ ŒùŒØŒ∫Œ∑œÉŒµ œÑŒø ŒÜŒªŒøŒ≥Œø " + dice;
        }
    }

    resetGame(){
        this.horses.forEach((h,i)=>{
            h.posX = this.startX;
            h.x = this.startX;
            h.y = this.lanesY[i];
        });

        this.diceText.setText("");
        this.winner = null;
        document.getElementById("msg").innerText="";
    }
}

new Phaser.Game({
    type: Phaser.AUTO,
    width:1200,
    height:720,
    scene: GameScene
});
</script>

</body>
</html>
